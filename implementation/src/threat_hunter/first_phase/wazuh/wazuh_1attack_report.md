# Wazuh Detection Report (Phase 1 – Linux Host Monitoring)
## Table of Contents
- [Purpose & Scope of Analysis](#1-purpose--scope-of-analysis)
- [Wazuh System Context](#2-wazuh-system-context)
- [Alert Log Overview](#3-alert-log-overview)
- [Authentication Failure Detection](#4-authentication-failure-detection)
  - [SSH Authentication Failures](#41-ssh-authentication-failures)
- [Privilege Escalation and Sudo Activity](#5-privilege-escalation-and-sudo-activity)
  - [Successful Privileged Sessions](#51-successful-privileged-sessions)
- [Alert Severity and Classification](#6-alert-severity-and-classification)
- [Detection Coverage Assessment](#7-detection-coverage-assessment)
- [Conclusion](#8-conclusion)

## 1. Purpose & Scope of Analysis

This report documents detection and logging behavior observed on the Wazuh SIEM during Phase 1 of the red team operation.  
The analysis focuses exclusively on alerts and events generated by Wazuh in relation to malicious activity performed on the Linux server (`ubuntu-srv`).

The purpose of this report is to:
- analyze Wazuh visibility into Linux attack activity,
- document generated alerts and their severity,
- correlate alerts with attacker actions,
- assess detection effectiveness during noisy attack phases.

---

## 2. Wazuh System Context

- Wazuh Server: `WAZUH-SIEM`
- Monitored host: `ubuntu-srv`
- Agent status: active and connected
- Alert log location: `/var/ossec/logs/alerts/alerts.log`

At the time of analysis, Wazuh was operational and actively collecting telemetry from the Linux host.

---

## 3. Alert Log Overview

The Wazuh alert log contained a significant number of entries related to authentication and privilege activity.

Total number of alerts recorded:

693 entries confirmed via alert log line count.

This is illustrated in the screenshot shown below, which displays the total number of alert entries present in the Wazuh alert log.

![Total number of Wazuh alerts](./images/alert_logs.png)
*Figure 1: Total number of Wazuh alerts*

---

## 4. Authentication Failure Detection

### 4.1 SSH Authentication Failures

Wazuh successfully detected multiple SSH authentication failures related to user `webadmin`.

Observed alert evidence includes repeated authentication failures originating from the Linux host itself.

Example alert evidence:

pam_unix(sshd:auth): authentication failure; user=webadmin  
Failed password for webadmin from 127.0.0.1

This activity is visible in the screenshots below, which document multiple SSH authentication failures associated with the `webadmin` account.

![SSH authentication failure – overview](./images/autentification_failure.png)
*Figure 2: SSH authentication failure – overview*

![SSH authentication failure – webadmin attempt 1](./images/wabadmin_autentification_failure1.png)
*Figure 3: SSH authentication failure – webadmin attempt 1*

![SSH authentication failure – webadmin attempt 2](./images/wabadmin_autentification_failure2.png)
*Figure 4: SSH authentication failure – webadmin attempt 2*


These screenshots show multiple failed authentication attempts being captured and logged by Wazuh.

This behavior indicates authentication flooding exceeding normal baseline patterns.

---

## 5. Privilege Escalation and Sudo Activity

### 5.1 Successful Privileged Sessions

Wazuh generated alerts related to successful privilege escalation events.

Detected events include:
- PAM login session opened
- Successful sudo execution
- Session closure events

Example alert evidence includes:

PAM: Login session opened  
Successful sudo to ROOT executed

These events are shown in the screenshots below, which capture Wazuh alerts related to PAM session handling and successful sudo execution.

![Wazuh alert – PAM login session opened](./images/alert_log_detail1.png)
*Figure 5: Wazuh alert – PAM login session opened*

![Wazuh alert – successful sudo execution](./images/alert_log_detail2.png)
*Figure 6: Wazuh alert – successful sudo execution*


The alerts confirm that Wazuh detected:
- elevation to root privileges,
- execution of commands as root,
- proper tracking of session lifecycle events.

---

## 6. Alert Severity and Classification

Observed alert rules include:
- Rule 5501 – PAM login session opened (level 3)
- Rule 5402 – Successful sudo to ROOT executed (level 3)
- Rule 5553 – PAM authentication misconfiguration (level 4)

These alert levels indicate low-to-moderate severity events, suitable for correlation rather than immediate incident escalation.

---

## 7. Detection Coverage Assessment

Wazuh demonstrated effective detection during the noisy phase of the attack by:

- capturing repeated authentication failures,
- logging privilege escalation events,
- tracking session creation and termination,
- correlating events with the monitored Linux host.

However, earlier stealth activity using valid credentials did not trigger alerts, which aligns with expected baseline behavior.

---

## 8. Conclusion

The Wazuh SIEM successfully detected and logged malicious activity on the Linux host once the attacker transitioned from stealthy behavior to noisy actions.

Authentication abuse and privilege escalation were clearly visible within the alert logs, providing sufficient evidence for forensic analysis and timeline reconstruction.

This confirms that Wazuh detection is effective for overt attack activity, while credential-based stealth access remains challenging to detect without additional correlation or custom rules.
